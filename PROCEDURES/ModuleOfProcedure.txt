
Public Function ModuleOfProcedure( _
                                 TargetWorkbook As Workbook, _
                                 ProcedureName As Variant) As VBComponent
'@BlogPosted
'@AssignedModule F_Vbe_Modules
    Dim ProcKind As VBIDE.vbext_ProcKind
    Dim lineNum As Long, NumProc As Long
    Dim Procedure As String
    Dim Module As VBComponent
    For Each Module In TargetWorkbook.VBProject.VBComponents
        With Module.codeModule
            lineNum = .CountOfDeclarationLines + 1
            Do Until lineNum >= .CountOfLines
                Procedure = .ProcOfLine(lineNum, ProcKind)
                If UCase(Procedure) = UCase(ProcedureName) Then
                    Set ModuleOfProcedure = Module
                    Exit Function
                End If
                lineNum = .procStartLine(Procedure, ProcKind) + .ProcCountLines(Procedure, ProcKind) + 1
            Loop
        End With
    Next Module
End Function
