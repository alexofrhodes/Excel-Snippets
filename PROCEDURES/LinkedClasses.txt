



Function LinkedClasses( _
                      TargetWorkbook As Workbook, _
                      Module As VBComponent, _
                      Procedure As String) As Collection
'@BlogPosted
'@AssignedModule F_VbeLinkedProcedures
'@INCLUDE PROCEDURE WorkbookOfModule
'@INCLUDE PROCEDURE ClassNames
'@INCLUDE PROCEDURE classCallsOfModule
'@INCLUDE PROCEDURE ProcedureCode

    Dim coll As New Collection
    Dim var As Variant
        var = classCallsOfModule(Module)
    Dim Code As String
        Code = ProcedureCode(TargetWorkbook, Module, Procedure)
    Dim keyword As String
    Dim ClassName As String
    Dim element As Variant
    Dim i As Long
    On Error Resume Next
    For i = LBound(var, 1) To UBound(var, 1)
        If InStr(1, Code, var(i, 1)) > 0 Or InStr(1, Code, var(i, 2)) > 0 Then
            coll.Add var(i, 1), var(i, 1)
        End If
    Next
    For Each element In ClassNames
        If InStr(1, Code, element) > 0 Then
            coll.Add element, CStr(element)
        End If
    Next
    On Error GoTo 0
    Set LinkedClasses = coll
End Function
