
Public Sub ArraySortBetween(vArray As Variant, inLow As Long, inHi As Long)
    Dim tmpSwap As Variant
    Dim tmpLow  As Long:    tmpLow = inLow
    Dim tmpHi   As Long:      tmpHi = inHi
    Dim Pivot   As Variant:    Pivot = vArray((inLow + inHi) \ 2)
    While (tmpLow <= tmpHi)
        While (vArray(tmpLow) < Pivot And tmpLow < inHi)
            tmpLow = tmpLow + 1
        Wend
        While (Pivot < vArray(tmpHi) And tmpHi > inLow)
            tmpHi = tmpHi - 1
        Wend
        If (tmpLow <= tmpHi) Then
            tmpSwap = vArray(tmpLow)
            vArray(tmpLow) = vArray(tmpHi)
            vArray(tmpHi) = tmpSwap
            tmpLow = tmpLow + 1
            tmpHi = tmpHi - 1
        End If
    Wend
    If (inLow < tmpHi) Then ArraySortBetween vArray, inLow, tmpHi
    If (tmpLow < inHi) Then ArraySortBetween vArray, tmpLow, inHi
End Sub
