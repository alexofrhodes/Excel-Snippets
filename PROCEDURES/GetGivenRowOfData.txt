
Private Function GetGivenRowOfData(Data As Variant, rowIndexes As Variant, colIndexes As Variant) As Variant
    Dim ValidRowIndexes As Collection
    Set ValidRowIndexes = ArrayToCollection(rowIndexes)
    Dim OutputColumnsIndexes As Collection
    Set OutputColumnsIndexes = ArrayToCollection(colIndexes)

    Dim Output As Variant
    If ValidRowIndexes.Count = 0 Then
        Exit Function
    End If
    ReDim Output(1 To ValidRowIndexes.Count, 1 To OutputColumnsIndexes.Count)
    Dim CurrentRow As Long
    Dim CurrentColumn As Long
    Dim ValidRowIndex As Variant
    For Each ValidRowIndex In ValidRowIndexes
        CurrentRow = CurrentRow + 1
        CurrentColumn = 0
        Dim OutputColumnsIndex As Variant
        For Each OutputColumnsIndex In OutputColumnsIndexes
            CurrentColumn = CurrentColumn + 1
            Output(CurrentRow, CurrentColumn) = Data(ValidRowIndex, OutputColumnsIndex)
        Next OutputColumnsIndex
    Next ValidRowIndex
    GetGivenRowOfData = Output

End Function
