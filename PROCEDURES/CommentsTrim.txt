
Function CommentsTrim(ByVal txt As String) As String
'@LastModified 2305220838
'@BlogPosted
'@AssignedModule F_Vbe_Comments
'@INCLUDE PROCEDURE ArrayRemoveEmptyElements
    Dim var As Variant
    ReDim var(0)
    Dim str As Variant
        str = Split(txt, vbNewLine)
    Dim j As Long
    Dim dif As Long
    Dim lineText As String
    Dim tmp As String
    For j = LBound(str) To UBound(str)
        lineText = Trim(str(j))
        If Left(lineText, 2) = "' " Then
            tmp = Mid(lineText, 2)
            dif = Len(tmp) - Len(LTrim(tmp))
            var(UBound(var)) = Space(dif) & "'" & LTrim(tmp)
            ReDim Preserve var(UBound(var) + 1)
        Else
            var(UBound(var)) = str(j)
            ReDim Preserve var(UBound(var) + 1)
        End If
    Next
    var = ArrayRemoveEmptyElements(var)
    CommentsTrim = Join(var, vbNewLine)
End Function
