
Sub ArrayToRange1d(arr As Variant, Horizontal As Boolean, Optional rng As Range)
    If ArrayDimensions(arr) <> 1 Then Exit Sub
    If rng Is Nothing Then
        If GetInputRange(rng, "select range", "select range") = False Then Exit Sub
    End If
    
    Dim dif As Long, difC As Long
    dif = IIf(LBound(arr) = 0, 1, 0)
    If Horizontal Then
        rng.RESIZE(, UBound(arr) + dif) = arr
    Else
        rng.RESIZE(UBound(arr) + dif) = WorksheetFunction.Transpose(arr)
    End If
    rng.TextToColumns rng, , , , , , True
End Sub
