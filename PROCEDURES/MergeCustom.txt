
Sub MergeCustom(Optional seper As String)
    If TypeName(Selection) <> "Range" Then Exit Sub
    If seper = "" Then seper = Chr(10)
    Dim SRange As Range
    Dim cell As Range
    Dim tmpStr As String
    Set SRange = Selection
    Dim element As Variant
    For Each element In SRange.Areas
        If element.MergeCells = True Then GoTo SKIP
        For Each cell In element.Cells
            tmpStr = tmpStr & seper & CStr(cell.Value)
        Next cell
        tmpStr = Mid(tmpStr, Len(seper) + 1)
        Application.DisplayAlerts = False
        With element
            .ClearContents
            .MERGE
            .Value = tmpStr
            .VerticalAlignment = xlCenter
            .HorizontalAlignment = xlCenter
        End With
        tmpStr = ""
SKIP:
    Next
    Application.DisplayAlerts = True
End Sub
