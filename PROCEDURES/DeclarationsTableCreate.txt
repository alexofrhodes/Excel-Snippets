
Sub DeclarationsTableCreate(TargetWorkbook As Workbook)
'@BlogPosted
'@INCLUDE PROCEDURE ArrayToRange2D
'@INCLUDE PROCEDURE CollectionsToArray2D
'@INCLUDE PROCEDURE DeclarationsWorksheetCreate
'@INCLUDE PROCEDURE DeclarationsTableSort
'@INCLUDE PROCEDURE getDeclarations
'@AssignedModule F_Vbe_Declararions

    DeclarationsWorksheetCreate
    
    Dim TargetWorksheet As Worksheet
    Set TargetWorksheet = ThisWorkbook.SHEETS("Declarations_Table")
    'if sheet was created within the hour, you probably don't have new declarations
    If Format(Now, "YYMMDDHHNN") - TargetWorksheet.Range("Z1").Value < 60 Then Exit Sub
    
    TargetWorksheet.Range("A2").CurrentRegion.OFFSET(1).clear
    ArrayToRange2D CollectionsToArray2D( _
                        getDeclarations( _
                            wb:=TargetWorkbook, _
                            includeScope:=True, _
                            includeType:=True, _
                            includeKeywords:=True, _
                            includeDeclarations:=True, _
                            includeComponentName:=True, _
                            includeComponentType:=True)), _
                    TargetWorksheet.Range("A2")
                                        
    TargetWorksheet.Range("Z1").Value = Format(Now, "YYMMDDHHNN")
    
    DeclarationsTableSort
End Sub
