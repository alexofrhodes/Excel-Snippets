
Public Function RegexCountMatches(TEXT As String, pattern As String) As Long
    Dim RE As New RegExp
    RE.pattern = pattern
    RE.Global = True
    RE.IgnoreCase = True
    RE.MultiLine = False
    Dim matches As matchCollection
    Set matches = RE.Execute(TEXT)
    RegexCountMatches = matches.Count
End Function
