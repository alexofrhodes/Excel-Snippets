
Public Function ArrayAppendIfUnique(ByVal NewString As String, ArrayName() As Variant) As Variant
'@BlogPosted
'@AssignedModule F_Array

'    Dim ArrayName() As Variant
'    Let ArrayName = [{"Andy", "Cara", "Josh"}]
'    ArrayName() = ArrayAppendIfUnique("Bill", ArrayName())
'    ArrayName() = ArrayAppendIfUnique("Andy", ArrayName())

    Dim EachValue As Variant
    Dim Duplicate As Boolean
    Dim ArrEmpty As Boolean

    ArrEmpty = False
    On Error Resume Next
    If UBound(ArrayName) = 0 Then ArrEmpty = True
    On Error GoTo 0

    Duplicate = False
    If ArrEmpty = False Then
        For Each EachValue In ArrayName
            If NewString = EachValue Then
                Duplicate = True
                Exit For
            End If
        Next
    End If

    If ArrEmpty = True Then
        ReDim ArrayName(1 To 1)
        ArrayName(1) = NewString
    ElseIf Duplicate = False Then
        ReDim Preserve ArrayName(LBound(ArrayName()) To UBound(ArrayName()) + 1)
        ArrayName(UBound(ArrayName)) = NewString
    End If
    Let ArrayAppendIfUnique = ArrayName
End Function
