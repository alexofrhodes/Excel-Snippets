
Public Function RecycleFile(Filename As String) As Boolean
    Dim SHFileOp As SHFILEOPSTRUCT
    Dim Res As Long
    If Dir(Filename, vbNormal) = vbNullString Then
        RecycleFile = True
        Exit Function
    End If
    With SHFileOp
        .wFunc = FO_DELETE
        .pFrom = Filename
        .fFlags = FOF_ALLOWUNDO
        .fFlags = FOF_ALLOWUNDO + FOF_NOCONFIRMATION
    End With
    Res = SHFileOperation(SHFileOp)
    If Res = 0 Then
        RecycleFile = True
    Else
        RecycleFile = False
    End If
End Function
