
Public Function ArrayDuplicates(ArrayOfValues) As String
    On Error GoTo Err_ArrayDuplicates
    Dim intUB As Integer
    Dim intElem As Integer
    Dim intLoop As Integer
    Dim intCount As Integer
    Dim varValue
    Dim varLoop
    Dim strResults As String
    intUB = UBound(ArrayOfValues)
    strResults = ""
    For intElem = 0 To intUB
        intCount = 0
        varValue = ArrayOfValues(intElem)
        If Not IsNull(varValue) Then
            For intLoop = 0 To intUB
                varLoop = ArrayOfValues(intLoop)
                If Not IsNull(varLoop) Then
                    If varLoop = varValue Then
                        intCount = intCount + 1
                    End If
                End If
            Next intLoop
            If intCount > 1 Then
                If InStr(strResults, varValue & ", ") = 0 Then
                    strResults = strResults & varValue & ", "
                End If
            End If
        End If
    Next intElem
    If Len(strResults) > 0 Then
        ArrayDuplicates = Left(strResults, Len(strResults) - 2)
    Else
        ArrayDuplicates = ""
    End If
Exit_ArrayDuplicates:
    On Error Resume Next
    Exit Function
Err_ArrayDuplicates:
    MsgBox Err.Number & " " & Err.Description, vbCritical, "ArrayDuplicates()"
    ArrayDuplicates = ""
    Resume Exit_ArrayDuplicates
End Function
