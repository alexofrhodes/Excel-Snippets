
Public Function EmptyRecycleBin(Optional DriveRoot As String = vbNullString) As Boolean
    Const SHERB_NOCONFIRMATION = &H1
    Const SHERB_NOPROGRESSUI = &H2
    Const SHERB_NOSOUND = &H4
    Dim Res As Long
    If DriveRoot <> vbNullString Then
        If PathIsNetworkPath(DriveRoot) <> 0 Then
            MsgBox "You can't empty the Recycle Bin of a network drive."
            Exit Function
        End If
    End If
    Res = SHEmptyRecycleBin(hWnd:=0&, _
    pszRootPath:=DriveRoot, _
    dwFlags:=SHERB_NOCONFIRMATION + _
    SHERB_NOPROGRESSUI + _
    SHERB_NOSOUND)
    If Res = 0 Then
        EmptyRecycleBin = True
    Else
        EmptyRecycleBin = False
    End If
End Function
