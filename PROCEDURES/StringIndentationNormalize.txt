

Function StringIndentationNormalize(ByVal txt As String, Optional indentation As Long = 4)
    Dim str As Variant
    str = Split(txt, vbNewLine)
    Dim sLine As String
    Dim tmpLine As String
    Dim i As Long
    Dim iSpaces As Long
    Dim tmpSpaes As Long
    For i = LBound(str) To UBound(str)
        sLine = str(i)
        iSpaces = Len(sLine) - Len(LTrim(sLine))
        If iSpaces > 0 Then
            str(i) = Space(RoundUp(iSpaces, indentation)) & Trim(sLine)
        End If
    Next
    If InStr(1, txt, vbNewLine) > 0 Then
        StringIndentationNormalize = Join(str, vbNewLine)
    Else
        StringIndentationNormalize = str
    End If
End Function
